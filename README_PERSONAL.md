**Заголовок и статус**
Randarc-Astra

Короткий слоган: Локальная станция‑автопилот для задач за компьютером.
Статус проекта: в разработке.
Дата актуальности: 5 февраля 2026.

**Суть продукта**
Randarc-Astra — это персональная станция, которая принимает запрос, сама превращает его в управляемый процесс и выполняет действия на компьютере как человек. Вся работа фиксируется, воспроизводится и остаётся локально.

**Зачем мне Astra**
- Мне нужен автономный помощник, который берёт на себя повторяемые действия на экране.
- Мне важно видеть логику решений и цепочку шагов, а не только итог.
- Мне нужно сохранять результаты и историю, чтобы повторять сценарии и улучшать их.
- Мне необходим контроль риска: любые опасные действия только после подтверждения.

**Как работает Astra (как станция, а не чат)**
- Запуск (Run) — отдельная работа по запросу, со статусами и журналом.
- План (Plan) — набор шагов, объясняющий, что будет сделано.
- Задача (Task) — выполнение одного шага.
- Событие (Event) — лог действий, ошибок и решений.
- Источники (Sources) — откуда были взяты данные.
- Факты (Facts) — извлечённые сведения.
- Артефакты (Artifacts) — файлы результата и промежуточные выводы.
- Память (Memory) — локальная база с поиском по прошлым результатам.

Интерфейс показывает цепочку ценности: план → прогресс → события → результат. Отдельная панель поверх экрана отображает текущую цель, шаг и последние действия автопилота.

Подробно про состояния/хоткеи/поток данных: `docs/STATE_OF_UI.md`.

**Ключевые сценарии**
Сценарий: Универсальный автопилот для задач на экране.
Шаги:
1. Захват экрана.
2. План следующего шага.
3. Действия мышью/клавиатурой.
4. Логирование событий.
5. Повтор цикла до завершения.

Сценарий: Найти официальный сайт X, выписать 5 фактов, сохранить отчёт. Запланировано как встроенный тест‑кейс.
Шаги:
1. Открыть браузер и найти сайт.
2. Собрать факты.
3. Сохранить результат в артефакт.

Сценарий: Яндекс Музыка → анализ «Мне нравится» → подбор по вайбу → плейлист. Пока не реализовано.
Шаги:
1. Открыть Яндекс Музыку и перейти в «Мне нравится».
2. Собрать список треков.
3. Построить профиль вайба по метаданным и доступным текстам.
4. Сгенерировать кандидатов и проверить, что треки существуют в сервисе.
5. Запросить подтверждение на создание плейлиста и добавление треков.
6. Создать плейлист и добавить треки.
7. Сформировать отчёт и сохранить артефакты.

**Безопасность и контроль**
- Режимы запуска: только план, исследование, выполнение с подтверждением, безопасный автопилот.
- Опасные действия определяются по ключевым словам запроса или по флагу ask_confirm от модели (например, оплата, покупка, перевод, подписка, удаление, отправка, публикация, создание плейлиста).
- Confirm Gate: перед опасными действиями создаётся запрос подтверждения.
- Все действия фиксируются в журнале событий.
- Остановка при паролях/2FA — Пока не реализовано.

**Что Astra умеет прямо сейчас**
- Создавать проекты, запуски, планы и журнал событий.
- Выполнять задачи в режиме автопилота: экран → действия → цикл.
- Показывать панель поверх экрана с целью, планом и действиями.
- Запрашивать подтверждения опасных действий.
- Сохранять логи и итоги в артефакты.
- Искать по локальной памяти результатов.

**Skills: какие есть и что каждый делает**
Skill — идентификатор навыка в системе.
| Skill | Для чего | Вход (очень коротко) | Выход (Sources/Facts/Artifacts) | Требует подтверждения |
| --- | --- | --- | --- | --- |
| autopilot_computer | Автопилот управления компьютером | goal, hints | Artifacts + События | Внутренний Confirm Gate |
| web_research | Поиск источников | query, urls | Sources | нет |
| extract_facts | Извлечение фактов | source_ids (опционально) | Facts | нет |
| conflict_scan | Поиск конфликтов | без входа | События (конфликты) | нет |
| report | Сбор отчёта | без входа | Artifacts (report.md) | нет |
| memory_save | Сохранение памяти | без входа | События | нет |
| computer | Управление ОС | actions | События | да |
| shell | Команды оболочки | command | События | да |

**Что хранится локально и где**
- База данных: `.astra/astra.db` (SQLite).
- Шифрованное хранилище секретов: `.astra/vault.bin`.
- Артефакты запусков: `artifacts/<run_id>/`.
- Для резервного копирования достаточно сохранять `.astra/` и `artifacts/`.

**Словарь терминов**
- Run (Запуск) — один запуск по запросу.
- Plan (План) — упорядоченные шаги запуска.
- Task (Задача) — выполнение одного шага.
- Event (Событие) — запись в журнале событий.
- Source (Источник) — источник данных.
- Fact (Факт) — извлечённый факт.
- Artifact (Артефакт) — файл результата.
- Memory (Память) — локальная база знаний.
- Approval / Confirm — подтверждение опасного действия.

**Дорожная карта (без обещаний)**
Следующий шаг (1–2 недели):
- Повышение устойчивости автопилота в реальных приложениях. Запланировано.
- Улучшение панели поверх экрана (больше контекста, меньше шума). Запланировано.

Потом:
- Аудио‑интерфейс (STT/TTS). Пока не реализовано.
- Автоматическое распознавание рискованных действий без подсказок. Запланировано.

**Ограничения текущей версии**
- Качество решений зависит от доступной языковой модели.
- Ошибки распознавания экрана возможны на нестандартных интерфейсах.
- Голосовые функции отсутствуют.

**Как проверять фактичность**
- Сверять факты с источниками в разделе Источники.
- Использовать список конфликтов для выявления расхождений.
- Хранить важные источники и артефакты локально.
